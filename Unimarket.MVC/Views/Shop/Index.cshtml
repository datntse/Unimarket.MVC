@model Unimarket.MVC.Models.ViewModels.ResponseProductVM

@{
    ViewData["Title"] = "Shop Page";
    var minPrice = ViewData["MinPrice"] != null ? (float)ViewData["MinPrice"] : 1000f;
    var maxPrice = ViewData["MaxPrice"] != null ? (float)ViewData["MaxPrice"] : 999999f;
}

<div class="breadcrumb-option">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="breadcrumb__links">
                    <a href="@Url.Action("Index","Home")"><i class="fa fa-home"></i> Trang chủ</a>
                    <span>Sản phẩm</span>
                </div>
            </div>
        </div>
    </div>
</div>

<section class="shop spad">
    <div class="container">
        <div class="row">
            <div class="col-lg-3 col-md-3">
                <div class="shop__sidebar">
                    <form method="get" action="@Url.Action("Index", "Shop")">
                        <div class="sidebar__filter">
                            <div class="filter-range-wrap">
                                <div id="price-range" class="price-range ui-slider ui-corner-all ui-slider-horizontal ui-widget ui-widget-content"
                                     data-min="@minPrice" data-max="@maxPrice"></div>
                                <div class="range-slider">
                                    <div class="price-input">
                                        <p>Price:</p>
                                        <input type="number" id="minPriceInput" name="MinPrice" placeholder="Min Price" value="@minPrice" step="0.01" />
                                        <br />
                                        <input type="number" id="maxPriceInput" name="MaxPrice" placeholder="Max Price" value="@maxPrice" step="0.01" />
                                    </div>
                                </div>
                            </div>
                            <button type="submit" style="font-size: 14px; color: #0d0d0d; text-transform: uppercase; letter-spacing: 2px; font-weight: 700; display: inline-block; padding: 5px 16px 5px 24px; border: 2px solid #ff0000; position: absolute; right: 0; bottom: -5px; border-radius: 2px;">
                                Filter
                            </button>
                        </div>
                        <div class="sidebar__color">
                            <div class="section-title">
                                <h4>Sort by category</h4>
                            </div>
                            <div class="size__list color__list">
                                @foreach (var category in new List<string> { "Quần", "Áo" }) 
                                {
                                    <div style="display:flex;">
                                        <input type="checkbox" name="categoryNames" value="@category" @(ViewData["categoryNames"] != null && ((List<string>)ViewData["categoryNames"]).Contains(category) ? "checked" : "") />
                                        <label style="margin-top:8px;" for="@category">@category</label>
                                    </div>
                                }
                            </div>
                            <button id="filterButton" style="font-size: 14px; color: #0d0d0d; text-transform: uppercase; letter-spacing: 2px; font-weight: 700; display: inline-block; padding: 5px 16px 5px 24px; border: 2px solid #ff0000; right: 0; bottom: -5px; border-radius: 2px;">
                                Filter
                            </button>
                        </div>
                        <a href="@Url.Action("Index")">Xóa tìm kiếm</a>
                    </form>
                </div>
            </div>
            <div class="col-lg-9 col-md-9">
                <div class="row">
                    @foreach (var item in Model.Data)
                    {
                        <div class="col-lg-4 col-md-6">
                            <div class="product__item">
                                <div class="product__item__pic set-bg" data-setbg="@item.ImageUrl">
                                    <ul class="product__hover">
                                        <li><a href="@item.ImageUrl" class="image-popup"><span class="arrow_expand"></span></a></li>
                                        <li><a asp-controller="ProductDetail" asp-action="Index" asp-route-id="@item.Id"><span class="icon_search"></span></a></li>
                                        <li><a href="#"><span class="icon_bag_alt"></span></a></li>
                                    </ul>
                                </div>
                                <div class="product__item__text">
                                    <h6><a asp-controller="ProductDetail" asp-action="Index" asp-route-id="@item.Id">@item.Name</a></h6>
                                    <div class="rating">
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                    </div>
                                    <div class="product__price">$ @item.Price</div>
                                </div>
                            </div>
                        </div>
                    }
                    <div class="col-lg-12 text-center">
                        <div class="pagination__option">
                            @for (int i = 1; i <= Model.Total; i++)
                            {
                                <a href="@Url.Action("Index", new {
                                    currentPage = i-1,
                                    MinPrice = ViewData["MinPrice"],
                                    MaxPrice = ViewData["MaxPrice"],
                                    categoryNames = ViewData["categoryNames"],
                                    sortBy = ViewData["sortBy"],
                                    isAscending = ViewData["isAscending"]
                                })" class="@(i == Model.CurrentPage ? "active" : "")">
                                    @i
                                </a>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
<script>
    $(function () {
        var $priceRange = $('#price-range');
        var minPrice = parseFloat($priceRange.data('min'));
        var maxPrice = parseFloat($priceRange.data('max'));

        // Initialize the slider
        $priceRange.slider({
            range: true,
            min: 1000,  // Minimum value you want for slider
            max: 999999, // Maximum value you want for slider
            values: [minPrice, maxPrice],
            slide: function (event, ui) {
                $('#minPriceInput').val(ui.values[0]);
                $('#maxPriceInput').val(ui.values[1]);
            }
        });

        // Update slider when inputs change
        $('#minPriceInput').change(function () {
            var min = parseFloat($(this).val());
            var max = parseFloat($('#maxPriceInput').val());
            $priceRange.slider('values', 0, min);
        });

        $('#maxPriceInput').change(function () {
            var min = parseFloat($('#minPriceInput').val());
            var max = parseFloat($(this).val());
            $priceRange.slider('values', 1, max);
        });
    });
</script>
